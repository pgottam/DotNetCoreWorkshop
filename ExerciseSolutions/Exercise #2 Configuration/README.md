Spring Cloud Service with Credhub backed by git - SteelToe App.
======================

This project provide instructions to integrate Spring Cloud Services 3 with credhub backed by git for configurations


1.  Install Spring Cloud Service Plugin on to the foundation - Refer https://github.com/pivotal-cf/spring-cloud-services-cli-plugin

       $ cf install-plugin -r CF-Community "spring-cloud-services"

2. Create a config server instance

       $ cf create-service p-config-server standard myConfigServer -c .\config.json

3. Add a secret to Run time Credhub

      $ cf config-server-add-credhub-secret myConfigServer bootcamp-api-mak/development/master/mysecret '{"key": "BootCamp-cred111"}'

4. Refer the secret "key" defined above in the JSON, in the application.properties as defined in your config repository.


Push It!
========

1.  Clone the repo  [DotNetCoreWorkshop/configuration](https://github.com/pgottam/DotNetCoreWorkshop.git) :
        export $PROJ_HOME=/DotNetCoreWorkshop/ExerciseSolutions/

        $ cd $PROJ_HOME/Exercise #2 Configuration

2.  Push the application!

        $ cf push

    You should see output similar to the following listing. Take a look
    at the listing callouts for a play-by-play of whatâ€™s happening:

----

    Pushing from manifest to org dev / space dotnet as admin...
    Using manifest file /Users/praveeng/Downloads/booth/DotNetCoreWorkshop/ExerciseSolutions/Exercise #2 Configuration/bootcamp-webapi/manifest.yml
    Getting app info...
    Updating app with these attributes...
    name:                bootcamp-api-mak
    path:                /Users/praveeng/Downloads/booth/DotNetCoreWorkshop/ExerciseSolutions/Exercise #2 Configuration/bootcamp-webapi
    buildpacks:
    https://github.com/cloudfoundry/dotnet-core-buildpack
    disk quota:          1G
    health check type:   port
    instances:           1
    memory:              256M
    stack:               cflinuxfs3
    services:
    myConfigServer
    env:
    ASPNETCORE_ENVIRONMENT
    routes:
    bootcamp-api-mak-responsive-tasmaniandevil.apps.pleasanthill.cf-app.com

    Updating app bootcamp-api-mak...
    Mapping routes...
    Comparing local files to remote cache...
    Packaging files to upload...
    Uploading files...
    196.79 KiB / 196.79 KiB [==========================================] 100.00% 1s

    Waiting for API to complete processing files...

    1 of 1 instances running
      Exit status 0
        Uploading droplet, build artifacts cache...
        Uploading droplet...
        Uploading build artifacts cache...
        Uploaded build artifacts cache (107.8M)
        Uploaded droplet (44M)
        Uploading complete
        Cell 95634fd4-7835-4609-908d-9d9a82dfa4f8 stopping instance 87eef130-daf2-4967-ae0f-44daf5486aff
        Cell 95634fd4-7835-4609-908d-9d9a82dfa4f8 destroying container for instance 87eef130-daf2-4967-ae0f-44daf5486aff

     Waiting for app to start...

     name:              bootcamp-api-mak
     requested state:   started
     routes:            bootcamp-api-mak-responsive-tasmaniandevil.apps.pleasanthill.cf-app.com
     last uploaded:     Wed 16 Oct 17:08:37 PDT 2019
     stack:             cflinuxfs3
     buildpacks:        dotnet-core

     type:            web
     instances:       1/1
     memory usage:    256M
     start command:   cd ${DEPS_DIR}/0/dotnet_publish && exec ./bootcamp-webapi
                      --server.urls http://0.0.0.0:${PORT}
          state     since                  cpu    memory      disk      details
     #0   running   2019-10-17T00:08:53Z   0.0%   0 of 256M   0 of 1G   

----

3.  Visit the application in your browser by hitting the route that was
    generated by the CLI or through Apps manager. Verify if the value is interpolated from credhub, which it should.
